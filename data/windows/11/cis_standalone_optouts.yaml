---
# CIS state:
# Removed 33 Domain-focused recommendations - 31 identified
# Modified several recommendations and tailored them for a Workgroup system - 0 identified
# ref: https://www.cisecurity.org/insights/blog/cis-benchmarks-august-2022-update

cis_security_hardening_windows::cis_standalone_optout:
  - "(L1) Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'"
  - "(L1) Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'"
  - "(L1) Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'"
  - "(L1) Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'"
  - "(L1) Ensure 'Domain member: Maximum machine account password age' is set to '30 or fewer days, but not 0'"
  - "(L1) Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'"
  - "(L1) Ensure 'Windows Firewall: Domain: Firewall state' is set to 'On (recommended)'"
  - "(L1) Ensure 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)'"
  - "(L1) Ensure 'Windows Firewall: Domain: Outbound connections' is set to 'Allow (default)'"
  - "(L1) Ensure 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'"
  - "(L1) Ensure 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log'"
  - "(L1) Ensure 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16,384 KB or greater'"
  - "(L1) Ensure 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes'"
  - "(L1) Ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes'"
  - "(L1) Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled'"
  - "(L1) Ensure 'Enable Local Admin Password Management' is set to 'Enabled'"
  - "(L1) Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters'"
  - "(L1) Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more'"
  - "(L1) Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer'"
  - "(L1) Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'"
  - "(L1) Ensure 'Require domain users to elevate when setting a networks location' is set to 'Enabled'"
  - "(L1) Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'"
  - "(L1) Ensure 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'"
  - "(L1) Ensure 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'"
  - "(L1) Ensure 'Turn off background refresh of Group Policy is set' to 'Disabled'"
  - "(L1) Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'"
  - "(L1) Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'"
  - "(L1) Ensure 'Turn off picture password sign-in' is set to 'Enabled'"
  - "(L2) Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)'"
  - "(L2) Ensure 'Enable Windows NTP Client' is set to 'Enabled'"
  - "(L2) Ensure 'Enable Windows NTP Server' is set to 'Disabled'"
## ----------- updates from CIS v4.0.0 - there is no v4.0.0 standalone so opt out all the new v4.0.0 Enterprise settings ----------- ##
  - "(L1) Ensure 'Turn on Basic feed authentication over HTTP' is set to 'Disabled'"
  - "(L1) Ensure 'Network security: LDAP client encryption requirements' is set to 'Negotiate sealing' or higher"
  - "(L1) Ensure 'Configure multicast DNS (mDNS) protocol' is set to 'Disabled'"
  - "(L1) Ensure 'Audit client does not support encryption' is set to 'Enabled'"
  - "(L1) Ensure 'Audit client does not support signing' is set to 'Enabled'"
  - "(L1) Ensure 'Audit insecure guest logon' is set to 'Enabled'"
  - "(L1) Ensure 'Enable authentication rate limiter' is set to 'Enabled'"
  - "(L1) Ensure 'Enable remote mailslots' is set to 'Disabled'"
  - "(L1) Ensure 'Mandate the minimum version of SMB' is set to 'Enabled: 3.1.1'"
  - "(L1) Ensure 'Set authentication rate limiter delay (milliseconds)' is set to 'Enabled: 2000' or more"
  - "(L1) Ensure 'Audit server does not support encryption' is set to 'Enabled'"
  - "(L1) Ensure 'Audit server does not support signing' is set to 'Enabled'"
  - "(L1) Ensure 'Configure RPC packet level privacy setting for incoming connections' is set to 'Enabled'"
  - "(L1) Ensure 'Configure the behavior of the sudo command' is set to 'Enabled: Disabled'"
  - "(L1) Ensure 'Block NetBIOS-based discovery for domain controller location' is set to 'Enabled'"
  - "(L1) Ensure 'Configure SAM change password RPC methods policy' is set to 'Enabled: Block all change password RPC methods'"
  - "(L1) Ensure 'Not allow per-user unsigned packages to install by default (requires explicitly allow per install)' is set to 'Enabled'"
  - "(L1) Ensure 'Enable App Installer Local Archive Malware Scan Override' is set to 'Disabled'"
  - "(L1) Ensure 'Enable App Installer Microsoft Store Source Certificate Validation Bypass' is set to 'Disabled'"
  - "(L1) Ensure 'Do not apply the Mark of the Web tag to files copied from insecure sources' is set to 'Disabled'"
  - "(L1) Ensure 'Control whether exclusions are visible to local users' is set to 'Enabled'"
  - "(L1) Ensure 'Enable EDR in block mode' is set to 'Enabled'"
  - "(L1) Ensure 'Configure real-time protection and Security Intelligence Updates during OOBE' is set to 'Enabled'"
  - "(L1) Ensure 'Configure Remote Encryption Protection Mode' is set to 'Enabled: Audit' or higher"
  - "(L1) Ensure 'Scan excluded files and directories during quick scans' is set to 'Enabled: 1'"
  - "(L1) Ensure 'Trigger a quick scan after X days without any scans' is set to 'Enabled: 7'"
  - "(L1) Ensure 'Require Encryption' is set to 'Enabled'"
  - "(L2) Ensure 'WinHTTP Web Proxy Auto-Discovery Service (WinHttpAutoProxySvc)' is set to 'Disabled'"
  - "(L2) Ensure 'Turn off default IPv6 DNS Servers' is set to 'Enabled'"
  - "(L2) Ensure 'Configure Windows protected print' is set to 'Enabled'" 
  - "(L2) Ensure 'Turn off API Sampling' is set to 'Enabled'"
  - "(L2) Ensure 'Turn off Application Footprint' is set to 'Enabled'" 
  - "(L2) Ensure 'Turn off Install Tracing' is set to 'Enabled'"
  - "(L2) Ensure 'Enable Windows Package Manager command line interfaces' is set to 'Disabled'" 
  - "(L2) Ensure 'Convert warn verdict to block' is set to 'Enabled'"
  - "(L2) Ensure 'Configure Brute-Force Protection aggressiveness' is set to 'Enabled: Medium' or higher" 
  - "(L2) Ensure 'Configure how aggressively Remote Encryption Protection blocks threats' is set to 'Enabled: Medium' or higher"
  - "(L2) Ensure 'Restrict clipboard transfer from server to client' is set to 'Enabled: Disable clipboard transfers from server to client'" 
  - "(L2) Ensure 'GameInput Service (GameInputSvc)' is set to 'Disabled'"
  - "(L2) Ensure 'Allow mapping folders into Windows Sandbox' is set to 'Disabled'"
