---
cis_security_hardening_windows::cis_level_1:

## ----------- Some entries are enforced by local_group_policy module, please check ../secpol.yaml ----------- ##

## ----------- CIS hardening Windows 10.1709 v1.4.0 ----------- ##

## Removed in v4.0.0
#  "(L1) Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'":
#    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\NoConnectedUser':
#      ensure:    present
#      data:      3

  "(L1) Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LimitBlankPasswordUse':
      ensure:    present

  "(L1) Ensure 'Audit: Force audit policy subcategory settings to override audit policy category settings' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SCENoApplyLegacyAuditPolicy':
      ensure:    present

  "(L1) Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\CrashOnAuditFail':
      ensure:    present
      data:      0

# Removed in v3.0.0
#  "(L1) Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators and Interactive Users'":
#    'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AllocateDASD':
#      ensure:    present
#      type:      'string'
#      data:      '2'

  "(L1) Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RequireSignOrSeal':
      ensure:    present

  "(L1) Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\SealSecureChannel':
      ensure:    present

  "(L1) Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\SignSecureChannel':
      ensure:    present

  "(L1) Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange':
      ensure:    present
      data:      0

  "(L1) Ensure 'Domain member: Maximum machine account password age' is set to '30 or fewer days, but not 0'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge':
      ensure:    present
      data:      30

  "(L1) Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RequireStrongKey':
      ensure:    present

  "(L1) Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableCAD':
      ensure:    present
      data:      0

## renamed from 'Interactive logon: Do not display last user name' in 1.5.0 v1803 
  "(L1) Ensure 'Interactive logon: Don't display last signed-in' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUserName':
      ensure:    present

  "(L1) Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\InactivityTimeoutSecs':
      ensure:    present
      data:      '900'

## Managed in Local Security Policy  
#  "(L1) Configure 'Interactive logon: Message text for users attempting to log on'":
#    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeText':
#      ensure:    present
#      type:      'string'
#      data:      '"all activities performed on this system will be monitored."'

## Managed in Local Security Policy  
#  "(L1) Configure 'Interactive logon: Message title for users attempting to log on'":
#    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeCaption':
#      ensure:    present
#      type:      'string'
#      data:      '"notice and consent banner"'

  "(L1) Ensure 'Interactive logon: Prompt user to change password before expiration is set' to 'between 5 and 14 days'":
    'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\PasswordExpiryWarning':
      ensure:    present
      data:      7

  "(L1) Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation or higher'":
    'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\ScRemoveOption':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\RequireSecuritySignature':
      ensure:    present

  "(L1) Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\EnableSecuritySignature':
      ensure:    present

  "(L1) Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\EnablePlainTextPassword':
      ensure:    present
      data:      0

  "(L1) Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\AutoDisconnect':
      ensure:    present
      data:      15

  "(L1) Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\RequireSecuritySignature':
      ensure:    present

  "(L1) Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\EnableSecuritySignature':
      ensure:    present

  "(L1) Ensure 'Microsoft network server: Disconnect clients when logon hours expire' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\enableforcedlogoff':
      ensure:    present

  "(L1) Ensure 'Microsoft network server: Server SPN target name validation level' is set to 'Accept if provided by client' or higher":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\SMBServerNameHardeningLevel':
      ensure:    present
      data:      2

  "(L1) Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RestrictAnonymousSAM':
      ensure:    present

  "(L1) Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RestrictAnonymous':
      ensure:    present

  "(L1) Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\DisableDomainCreds':
      ensure:    present

  "(L1) Ensure 'Network access: Let Everyone permissions apply to anonymous users' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\EveryoneIncludesAnonymous':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network access: Named Pipes that can be accessed anonymously' is set to 'None'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\NullSessionPipes':
      ensure:    present
      type:      'array'
      data:      []

  "(L1) Ensure 'Network access: Remotely accessible registry paths' is configured":
    'HKLM\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths\Machine':
      ensure:    present
      type:      'array'
      data:      ['System\CurrentControlSet\Control\ProductOptions','System\CurrentControlSet\Control\Server Applications','SOFTWARE\Microsoft\Windows NT\CurrentVersion']

  "(L1) Ensure 'Network access: Remotely accessible registry paths and sub-paths' is configured":
    'HKLM\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths\Machine':
      ensure:    present
      type:      'array'
      data:      ['System\CurrentControlSet\Control\Print\Printers','System\CurrentControlSet\Services\Eventlog','SOFTWARE\Microsoft\OLAP Server','SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print','SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows','System\CurrentControlSet\Control\ContentIndex','System\CurrentControlSet\Control\Terminal Server','System\CurrentControlSet\Control\Terminal Server\UserConfig','System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration','SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib','System\CurrentControlSet\Services\SysmonLog']

  "(L1) Ensure 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\RestrictNullSessAccess':
      ensure:    present

  "(L1) Ensure 'Network access: Restrict clients allowed to make remote calls to SAM' is set to 'Administrators: Remote Access: Allow'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\restrictremotesam':
      ensure:    present
      type:      'string'
      data:      'O:BAG:BAD:(A;;RC;;;BA)'

  "(L1) Ensure 'Network access: Shares that can be accessed anonymously' is set to 'None'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\NullSessionShares':
      ensure:    present
      type:      'array'
      data:      []

  "(L1) Ensure 'Network access: Sharing and security model for local accounts' is set to 'Classic - local users authenticate as themselves'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ForceGuest':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\UseMachineId':
      ensure:    present

  "(L1) Ensure 'Network security: Allow LocalSystem NULL session fallback' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\AllowNullSessionFallback':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\pku2u\AllowOnlineID':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network security: Configure encryption types allowed for Kerberos' is set to 'AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters\SupportedEncryptionTypes':
      ensure:    present
      data:      '2147483640'

  "(L1) Ensure 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NoLMHash':
      ensure:    present

  "(L1) Ensure 'Network security: LAN Manager authentication level' is set to Send NTLMv2 response only. Refuse LM & NTLM'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LmCompatibilityLevel':
      ensure:    present
      data:      5

  "(L1) Ensure 'Network security: LDAP client signing requirements' is set to 'Negotiate signing or higher'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LDAP\LDAPClientIntegrity':
      ensure:    present

  "(L1) Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinClientSec':
      ensure:    present
      data:      '537395200'

  "(L1) Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinServerSec':
      ensure:    present
      data:      '537395200'

  "(L1) Ensure 'System objects: Require case insensitivity for nonWindows subsystems' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel\ObCaseInsensitive':
      ensure:    present

  "(L1) Ensure 'System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\ProtectionMode':
      ensure:    present

  "(L1) Ensure 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\FilterAdministratorToken':
      ensure:    present

## removed in v1.6.0 1809
#  "(L1) User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop is set to Disabled":
#    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableUIADesktopToggle':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is set to 'Prompt for consent on the secure desktop'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin':
      ensure:    present
      data:      1

  "(L1) Ensure 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorUser':
      ensure:    present
      data:      0

  "(L1) Ensure 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableInstallerDetection':
      ensure:    present

  "(L1) Ensure 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableSecureUIAPaths':
      ensure:    present

  "(L1) Ensure 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA':
      ensure:    present

  "(L1) Ensure 'User Account Control: Switch to the secure desktop when prompting for elevation' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\PromptOnSecureDesktop':
      ensure:    present

  "(L1) Ensure 'User Account Control: Virtualize file and registry write failures to per-user locations' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableVirtualization':
      ensure:    present

## removed in v1.5.0 1803
#  "(L1) Bluetooth Handsfree Service (BthHFSrv) is set to Disabled":
#    'HKLM\SYSTEM\CurrentControlSet\Services\BthHFSrv\Start':
#      ensure:    present
#      data:      4

  "(L1) Ensure 'Computer Browser (Browser)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Browser\Start':
      ensure:    present
      data:      4

# Removed in 1.5.0 v1803
#  "(L1) HomeGroup Listener (HomeGroupListener) is set to Disabled":
#    'HKLM\SYSTEM\CurrentControlSet\Services\HomeGroupListener\Start':
#      ensure:    present
#      data:      4

# Removed in 1.5.0 v1803
#  "(L1) HomeGroup Provider (HomeGroupProvider) is set to Disabled":
#    'HKLM\SYSTEM\CurrentControlSet\Services\HomeGroupProvider\Start':
#      ensure:    present
#      data:      4

  "(L1) Ensure 'IIS Admin Service (IISADMIN)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\IISADMIN\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Infrared monitor service (irmon)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\irmon\Start':
      ensure:    present
      data:      4

# Removed in v3.0.0
#  "(L1) Ensure 'Internet Connection Sharing (ICS) (SharedAccess)' is set to 'Disabled'":
#    'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Start':
#      ensure:    present
#      data:      4

  "(L1) Ensure 'LxssManager (LxssManager) is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LxssManager\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Microsoft FTP Service (FTPSVC)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\FTPSVC\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Remote Procedure Call (RPC) Locator (RpcLocator)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\RpcLocator\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Routing and Remote Access (RemoteAccess)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\RemoteAccess\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Simple TCP/IP Services (simptcp)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\simptcp\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'SSDP Discovery (SSDPSRV)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\SSDPSRV\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'UPnP Device Host (upnphost)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\upnphost\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Web Management Service (WMSvc)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\WMSvc\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Windows Media Player Network Sharing Service (WMPNetworkSvc)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Windows Mobile Hotspot Service (icssvc)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\icssvc\Start':
      ensure:    present
      data:      4

## removed in v1.9.0 2004
#  "(L1) Windows Store Install Service (InstallService) is set to Disabled":
#    'HKLM\SYSTEM\CurrentControlSet\Services\InstallService\Start':
#      ensure:    present
#      data:      4

  "(L1) Ensure 'World Wide Web Publishing Service (W3SVC)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\W3SVC\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Xbox Accessory Management Service (XboxGipSvc)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\XboxGipSvc\Start':
      ensure:    present
      data:      4

## removed in v1.6.0 1809
#  "(L1) Xbox Game Monitoring (xbgm) is set to Disabled":
#      'HKLM\SYSTEM\CurrentControlSet\Services\xbgm\Start':
#        ensure:    present
#        data:      4

  "(L1) Ensure 'Xbox Live Auth Manager (XblAuthManager)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\XblAuthManager\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Xbox Live Game Save (XblGameSave)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\XblGameSave\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Xbox Live Networking Service (XboxNetApiSvc)' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\XboxNetApiSvc\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Windows Firewall: Domain: Firewall state' is set to 'On (recommended)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\EnableFirewall':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\DefaultInboundAction':
      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Windows Firewall: Domain: Outbound connections' is set to 'Allow (default)'":
#    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\DefaultOutboundAction':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\DisableNotifications':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging\LogFilePath':
      ensure:    present
      type:      'string'
      data:      '%SYSTEMROOT%\System32\logfiles\firewall\domainfw.log'

  "(L1) Ensure 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16,384 KB or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging\LogFileSize':
      ensure:    present
      data:      '16384'

  "(L1) Ensure 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging\LogDroppedPackets':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging\LogSuccessfulConnections':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Private: Firewall state' is set to 'On (recommended)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\EnableFirewall':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Private: Inbound connections' is set to 'Block (default)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\DefaultInboundAction':
      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Windows Firewall: Private: Outbound connections' is set to 'Allow (default)'":
#    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\DefaultOutboundAction':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Windows Firewall: Private: Settings: Display a notification' is set to 'No'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\DisableNotifications':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\privatefw.log'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging\LogFilePath':
      ensure:    present
      type:      'string'
      data:      '%SYSTEMROOT%\System32\logfiles\firewall\privatefw.log'

  "(L1) Ensure 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16,384 KB or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging\LogFileSize':
      ensure:    present
      data:      '16384'

  "(L1) Ensure 'Windows Firewall: Private: Logging: Log dropped packets' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging\LogDroppedPackets':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Private: Logging: Log successful connections' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging\LogSuccessfulConnections':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Public: Firewall state' is set to 'On (recommended)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\EnableFirewall':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Public: Inbound connections' is set to 'Block (default)'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\DefaultInboundAction':
      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Windows Firewall: Public: Outbound connections' is set to 'Allow (default)'":
#    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\DefaultOutboundAction':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Windows Firewall: Public: Settings: Display a notification' is set to 'No'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\DisableNotifications':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Public: Settings: Apply local firewall rules' is set to 'No'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\AllowLocalPolicyMerge':
      ensure:    present
      data:      0

  "(L1) Ensure 'Windows Firewall: Public: Settings: Apply local connection security rules' is set to 'No'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\AllowLocalIPsecPolicyMerge':
      ensure:    present
      data:      0

  "(L1) Ensure 'Windows Firewall: Public: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\publicfw.log'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging\LogFilePath':
      ensure:    present
      type:      'string'
      data:      '%SYSTEMROOT%\System32\logfiles\firewall\publicfw.log'

  "(L1) Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16,384 KB or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging\LogFileSize':
      ensure:    present
      data:      '16384'

  "(L1) Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging\LogDroppedPackets':
      ensure:    present

  "(L1) Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging\LogSuccessfulConnections':
      ensure:    present

  "(L1) Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Personalization\NoLockScreenCamera':
      ensure:    present

  "(L1) Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Personalization\NoLockScreenSlideshow':
      ensure:    present

## Renamed from Allow input personalization in v1.6.0 1809
  "(L1) Ensure 'Allow users to enable online speech recognition services is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\InputPersonalization\AllowInputPersonalization':
      ensure:    present
      data:      0

# Removed in v3.0.0
#  "(L1) Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft Services\AdmPwd\PwdExpirationProtectionEnabled':
#      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Enable Local Admin Password Management' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft Services\AdmPwd\AdmPwdEnabled':
#      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters'":
#    'HKLM\SOFTWARE\Policies\Microsoft Services\AdmPwd\PasswordComplexity':
#      ensure:    present
#      data:      4

# Removed in v3.0.0
#  "(L1) Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more'":
#    'HKLM\SOFTWARE\Policies\Microsoft Services\AdmPwd\PasswordLength':
#      ensure:    present
#      data:      15

# Removed in v3.0.0
#  "(L1) Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer'":
#    'HKLM\SOFTWARE\Policies\Microsoft Services\AdmPwd\PasswordAgeDays':
#      ensure:    present
#      data:      30

  "(L1) Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver'":
    'HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb10\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Configure SMB v1 server' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\SMB1':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel\DisableExceptionChainValidation':
      ensure:    present
      data:      0

## Set NetBIOS node type to P-node (Ensure NetBT Parameter NodeType is set to 0x2 (2))
## Renamed from Set 'NetBIOS node type' in 1.7.0 v1903
  "(L1) Ensure 'NetBT NodeType configuration' is set to 'Enabled: P-node'":
    'HKLM\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\NodeType':
      ensure:    present
      data:      2

## removed in v1.6.0 1809
#  "(L1) Turn on Windows Defender protection against Potentially Unwanted Applications is set to Enabled":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine\MpEnablePus':
#      ensure:    present

  "(L1) Ensure 'WDigest Authentication' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential':
      ensure:    present
      data:      0

# Renamed in v3.0.0 (removed 'not recommended')
  "(L1) Ensure 'MSS: (AutoAdminLogon) Enable Automatic Logon' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AutoAdminLogon':
      ensure:    present
      type:      'string'
      data:      '0'

# Renamed in v3.0.0
  "(L1) Ensure 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level' is set to 'Enabled: Highest protection, source routing is completely disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\DisableIPSourceRouting':
      ensure:    present
      data:      2

# Renamed in v3.0.0
  "(L1) Ensure 'MSS: (DisableIPSourceRouting) IP source routing protection level' is set to 'Enabled: Highest protection, source routing is completely disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\DisableIPSourceRouting':
      ensure:    present
      data:      2

  "(L1) Ensure 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\EnableICMPRedirect':
      ensure:    present
      data:      0

  "(L1) Ensure 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\NoNameReleaseOnDemand':
      ensure:    present

# Renamed in v3.0.0
  "(L1) Ensure 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDllSearchMode':
      ensure:    present

# Renamed in v3.0.0
  "(L1) Ensure 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires' is set to 'Enabled: 5 or fewer seconds'":
    'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\ScreenSaverGracePeriod':
      ensure:    present
      type:      'string'
      data:      '0'

  "(L1) Ensure 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning is set' to 'Enabled: 90% or less'":
    'HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security\WarningLevel':
      ensure:    present
      data:      '90'

  "(L1) Ensure 'Turn off multicast name resolution' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient\EnableMulticast':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable insecure guest logons' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\AllowInsecureGuestAuth':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Network Connections\NC_AllowNetBridge_NLA':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Network Connections\NC_ShowSharedAccessUI':
      ensure:    present
      data:      0

  "(L1) Ensure 'Require domain users to elevate when setting a networks location' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Network Connections\NC_StdDomainUserSetLocation':
      ensure:    present

# Registry paths with multiple backslashes are managed in the cis manifest
#  "(L1) Ensure Hardened UNC Paths is set to Enabled, with "Require Mutual Authentication", "Require Integrity" and "Require Privacy" set for all NETLOGON and SYSVOL shares":
#      'HKLM\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths\\\*\NETLOGON':
#        ensure:    present
#        type:      'string'
#        data:      'RequireMutualAuthentication=1, RequireIntegrity=1'

#  "(L1) "":
#      'HKLM\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths\\\*\SYSVOL':
#        ensure:    present
#        type:      'string'
#        data:      'RequireMutualAuthentication=1, RequireIntegrity=1'

## Updated in 1903/9 v1.7.0/v1.8.0 from 1 to 3
  "(L1) Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled: 3 = Prevent Wi-Fi when on Ethernet'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy\fMinimizeConnections':
      ensure:    present
      data:      3

  "(L1) Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy\fBlockNonDomain':
      ensure:    present

  "(L1) Ensure 'Allow Windows to automatically connect to suggested open hotspots, to networks shared by contacts, and to hotspots offering paid services' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config\AutoConnectAllowedOEM':
      ensure:    present
      data:      0

## changed from disabled to enabled in v1.12.0 21H2
  "(L1) Ensure 'Include command line in process creation events' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit\ProcessCreationIncludeCmdLine_Enabled':
      ensure:    present

  "(L1) Ensure 'Remote host allows delegation of non-exportable credentials' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation\AllowProtectedCreds':
      ensure:    present

  "(L1) Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'":
    'HKLM\SYSTEM\CurrentControlSet\Policies\EarlyLaunch\DriverLoadPolicy':
      ensure:    present
      data:      3

  "(L1) Ensure 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}\NoBackgroundPolicy':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}\NoGPOListChanges':
      ensure:    present
      data:      0

  "(L1) Ensure 'Continue experiences on this device' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\EnableCdp':
      ensure:    present
      data:      0

## Needs to be set to 'ensure => absent' to pass Nessus !
  "(L1) Ensure 'Turn off background refresh of Group Policy is set' to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableBkGndGroupPolicy':
      ensure:    absent
#        data:      0

  "(L1) Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\DisableWebPnPDownload':
      ensure:    present

  "(L1) Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoWebServices':
      ensure:    present

  "(L1) Ensure 'Block user from showing account details on signin' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\BlockUserFromShowingAccountDetailsOnSignin':
      ensure:    present

  "(L1) Ensure 'Do not display network selection UI' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\DontDisplayNetworkSelectionUI':
      ensure:    present

  "(L1) Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\DontEnumerateConnectedUsers':
      ensure:    present

  "(L1) Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\EnumerateLocalUsers':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\DisableLockScreenAppNotifications':
      ensure:    present

  "(L1) Ensure 'Turn off picture password sign-in' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\BlockDomainPicturePassword':
      ensure:    present

  "(L1) Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\AllowDomainPINLogon':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9\DCSettingIndex':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9\ACSettingIndex':
      ensure:    present
      data:      0

  "(L1) Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\DCSettingIndex':
      ensure:    present

  "(L1) Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\ACSettingIndex':
      ensure:    present

  "(L1) Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fAllowUnsolicited':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fAllowToGetHelp':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Rpc\EnableAuthEpResolution':
      ensure:    present

  "(L1) Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Rpc\RestrictRemoteClients':
      ensure:    present

  "(L1) Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\MSAOptional':
      ensure:    present

  "(L1) Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoAutoplayfornonVolume':
      ensure:    present

  "(L1) Ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoAutorun':
      ensure:    present

  "(L1) Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDriveTypeAutoRun':
      ensure:    present
      data:     '255'

  "(L1) Ensure 'Configure enhanced anti-spoofing' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures\EnhancedAntiSpoofing':
      ensure:    present

  "(L1) Ensure 'Turn off Microsoft consumer experiences' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent\DisableWindowsConsumerFeatures':
      ensure:    present

  "(L1) Ensure 'Require pin for pairing' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Connect\RequirePinForPairing':
      ensure:    present

  "(L1) Ensure 'Do not display the password reveal button' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\CredUI\DisablePasswordReveal':
      ensure:    present

  "(L1) Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators':
      ensure:    present
      data:      0

## renamed from 'Allow Telemetry is set to Enabled: 0 - Security [Enterprise Only] or Enabled: 1 - Basic' in v1.12.0
  "(L1) Ensure 'Allow Diagnostic Data' is set to 'Enabled: Diagnostic data off (not recommended)' or 'Enabled: Send required diagnostic data'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\AllowTelemetry':
      ensure:    present
      data:      0

## removed in 1.5.0 v1803
#  "(L1) Disable pre-release features or settings is set to Disabled":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds\EnableConfigFlighting':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Do not show feedback notifications' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\DoNotShowFeedbackNotifications':
      ensure:    present

## Removed in v4.0.0
#  "(L1) Ensure 'Toggle user control over Insider builds' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds\AllowBuildPreview':
#      ensure:    present
#      data:      0

## Various values are acceptable here, selected (100 = BITS only)
  "(L1) Ensure 'Download Mode' is NOT set to 'Enabled: Internet'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization\DODownloadMode':
      ensure:    present
      data:      '100'

  "(L1) Ensure 'Application: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\Retention':
      ensure:    present
      type:      'string'
      data:      '0'

  "(L1) Ensure 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\MaxSize':
      ensure:    present
      data:      '32768'

  "(L1) Ensure 'Security: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security\Retention':
      ensure:    present
      type:      'string'
      data:      '0'

  "(L1) Ensure 'Security: Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security\MaxSize':
      ensure:    present
      data:      '196608'

  "(L1) Ensure 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup\Retention':
      ensure:    present
      type:      'string'
      data:      '0'

  "(L1) Ensure 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup\MaxSize':
      ensure:    present
      data:      '32768'

  "(L1) Ensure 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\System\Retention':
      ensure:    present
      type:      'string'
      data:      '0'

  "(L1) Ensure 'System: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\EventLog\System\MaxSize':
      ensure:    present
      data:      '32768'

  "(L1) Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoDataExecutionPrevention':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn off heap termination on corruption' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoHeapTerminationOnCorruption':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\PreXPSP2ShellProtocolBehavior':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prevent the computer from joining a homegroup' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\HomeGroup\DisableHomeGroup':
      ensure:    present

  "(L1) Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftAccount\DisableUserAuth':
      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Allow Address bar drop-down list suggestions' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\ServiceUI\ShowOneBox':
#      ensure:    present
#      data:      0

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Allow Adobe Flash' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Addons\FlashPlayerEnabled':
#      ensure:    present
#      data:      0

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Allow InPrivate Browsing' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\AllowInPrivate':
#      ensure:    present
#      data:      0

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Configure cookies' is set to 'Enabled: Block only 3rd-party cookies or higher'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\Cookies':
#      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Configure Password Manager' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\FormSuggest Passwords':
#      ensure:    present
#      type:      'string'
#      data:      'no'

## removed in v1.11.0 21H1
#  This setting has inverted logic !
#  "(L1) Ensure 'Configure Pop-up Blocker' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\AllowPopups':
#      ensure:    present
#      type:      'string'
#      data:      'yes'

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Configure search suggestions in Address bar' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\SearchScopes\ShowSearchSuggestionsGlobal':
#      ensure:    present
#      data:      0

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Configure the Adobe Flash Click-to-Run setting' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Security\FlashClickToRunMode':
#      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Prevent access to the about:flags page in Microsoft Edge is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\PreventAccessToAboutFlagsInMicrosoftEdge':
#      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Prevent bypassing Windows Defender SmartScreen prompts for files' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter\PreventOverrideAppRepUnknown':
#      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Prevent certificate error overrides' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Internet Settings\PreventCertErrorOverrides':
#      ensure:    present

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Prevent using Localhost IP address for WebRTC' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main\HideLocalHostIP':
#      ensure:    present

  "(L1) Ensure 'Configure local setting override for reporting to Microsoft MAPS is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\LocalSettingOverrideSpynetReporting':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled: Block'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection\EnableNetworkProtection':
      ensure:    present

  "(L1) Ensure 'Turn on behavior monitoring' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring':
      ensure:    present
      data:      0

  "(L1) Ensure 'Scan removable drives' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan\DisableRemovableDriveScanning':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn on e-mail scanning' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan\DisableEmailScanning':
      ensure:    present
      data:      0

## Removed in v4.0.0
## This registry_value may not be idempotent, causing boot loops after Windows Update has occurred
#  "(L1) Ensure 'Turn off Microsoft Defender AntiVirus' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Prevent the usage of OneDrive for file storage' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive\DisableFileSyncNGSC':
      ensure:    present

  "(L1) Ensure 'Do not allow passwords to be saved' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\DisablePasswordSaving':
      ensure:    present

  "(L1) Ensure 'Do not allow drive redirection' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fDisableCdm':
      ensure:    present

  "(L1) Ensure 'Always prompt for password upon connection' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fPromptForPassword':
      ensure:    present

  "(L1) Ensure 'Require secure RPC communication' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fEncryptRPCTraffic':
      ensure:    present

  "(L1) Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MinEncryptionLevel':
      ensure:    present
      data:      3

  "(L1) Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\DeleteTempDirsOnExit':
      ensure:    present

## removed in v1.9.0 2004
#  "(L1) Do not use temporary folders per session is set to Disabled":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\PerSessionTempDir':
#      ensure:    present

  "(L1) Ensure 'Prevent downloading of enclosures' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds\DisableEnclosureDownload':
      ensure:    present

  "(L1) Ensure 'Allow Cortana' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search\AllowCortana':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow Cortana above lock screen' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search\AllowCortanaAboveLock':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow indexing of encrypted files' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search\AllowIndexingEncryptedStoresOrItems':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow search and Cortana to use location' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search\AllowSearchToUseLocation':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn off Automatic Download and Install of updates' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore\AutoDownload':
      ensure:    present
      data:      4

  "(L1) Ensure 'Turn off the offer to update to the latest version of Windows' is set to 'Enabled":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore\DisableOSUpgrade':
      ensure:    present

#  "(L1) " - not present in 1809 - may have been a buggy entry created by 1803?":
#      'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AllowAppHVSI':
#        ensure:    present
#        data:      0

  "(L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\EnableSmartScreen':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\ShellSmartScreenLevel':
      ensure:    present
      type:      'string'
      data:      'Block'

# Removed in v3.0.0
#  "(L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter\EnabledV9':
#      ensure:    present

# Removed in v3.0.0
#  "(L1) Ensure 'Prevent bypassing Windows Defender SmartScreen prompts for sites' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter\PreventOverride':
#      ensure:    present

  "(L1) Ensure 'Enables or disables Windows Game Recording and Broadcasting' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR\AllowGameDVR':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: On, but disallow access above lock' OR 'Disabled but not Enabled: On'":
    'HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace\AllowWindowsInkWorkspace':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow user control over installs' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\EnableUserControl':
      ensure:    present
      data:      0

  "(L1) Ensure 'Always install with elevated privileges is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\SafeForScripting':
      ensure:    present
      data:      0

  "(L1) Ensure 'Sign-in and lock last interactive user automatically after a restart' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableAutomaticRestartSignOn':
      ensure:    present

# Moved to L2 in v3.0.0
# changed from disabled to enabled in v1.12.0 21H2
#  "(L1) Ensure 'Turn on PowerShell Script Block Logging' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging\EnableScriptBlockLogging':
#      ensure:    present

# Moved to L2 in v3.0.0
# changed from disabled to enabled in v2.0.0 22H2
#  "(L1) Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription\EnableTranscripting':
#      ensure:    present

  "(L1) WinRM Client: Ensure 'Allow Basic authentication' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowBasic':
      ensure:    present
      data:      0

  "(L1) WinRM Client: Ensure 'Allow unencrypted traffic' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowUnencryptedTraffic':
      ensure:    present
      data:      0

  "(L1) WinRM Client: Ensure 'Disallow Digest authentication' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowDigest':
      ensure:    present
      data:      0

  "(L1) WinRM Service: Ensure 'Allow Basic authentication' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\AllowBasic':
      ensure:    present
      data:      0

  "(L1) WinRM Service: Ensure 'Allow unencrypted traffic' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\AllowUnencryptedTraffic':
      ensure:    present
      data:      0

  "(L1) WinRM Service: Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\DisableRunAs':
      ensure:    present

  "(L1) Ensure 'Prevent users from modifying settings' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection\DisallowExploitProtectionOverride':
      ensure:    present

  "(L1) Ensure 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU\NoAutoRebootWithLoggedOnUsers':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure Automatic Updates' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU\NoAutoUpdate':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure Automatic Updates: Scheduled install day' is set to '0 - Every day'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU\ScheduledInstallDay':
      ensure:    present
      data:      0

  "(L1) Ensure 'Manage preview builds' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\ManagePreviewBuilds':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\ManagePreviewBuildsPolicyValue':
      ensure:    present

  "(L1) Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled: 180 or more'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\DeferFeatureUpdates':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\DeferFeatureUpdatesPeriodInDays':
      ensure:    present
      data:      '180'
## removed in 1903 v1.7.0 (Semi-Annual Channel for 1809 and below)
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\BranchReadinessLevel':
#      ensure:    present
#      data:      '32'

  "(L1) Ensure 'Select when Quality Updates are received' is set to 'Enabled: 0 days'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\DeferQualityUpdates':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\DeferQualityUpdatesPeriodInDays':
      ensure:    present
      data:      0

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Allow auditing events in Microsoft Defender Application Guard is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AuditApplicationGuard':
      ensure:    present

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Allow data persistence for Microsoft Defender Application Guard' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AllowPersistence':
      ensure:    present
      data:      0

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Configure Microsoft Defender Application Guard clipboard settings: Clipboard behavior setting' is set to 'Enabled: Enable clipboard operation from an isolated session to the host'":
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AppHVSIClipboardSettings':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AppHVSIClipboardFileType':
      ensure:    present

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Turn on Microsoft Defender Application Guard in Managed Mode' is set to 'Enabled'":
  # changed from 3 to 1 in v1.6.0 1809 so virtualisation is Edge only, not Edge & Office
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AllowAppHVSI_ProviderSet':
      ensure:    present




## ----------- updates from CIS 1803 v1.5.0 ----------- ##

  "(L1) Ensure 'Encryption Oracle Remediation' is set to 'Enabled: Force Updated Clients'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters\AllowEncryptionOracle':
      ensure:    present
      data:      0

## Removed in v4.0.0
#  "(L1) Ensure 'Only display the private store within the Microsoft Store' is set to 'Enabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore\RequirePrivateStoreOnly':
#      ensure:    present

  "(L1) Ensure 'Require use of specific security layer for remote (RDP) connections' is set to 'Enabled: SSL'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\SecurityLayer':
      ensure:    present
      data:      2

  "(L1) Ensure 'Require user authentication for remote connections by using Network Level Authentication' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\UserAuthentication':
      ensure:    present

  "(L1) Ensure 'OpenSSH SSH Server (sshd)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\sshd\Start':
      ensure:    present
      data:      4

  "(L1) Ensure 'Configure Attack Surface Reduction rules is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\ExploitGuard_ASR_Rules':
      ensure:    present

  "(L1) Ensure 'ASR - Block Office communication application from creating child processes' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\26190899-1602-49e8-8b27-eb1d0a1ce869':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block Office applications from creating executable content' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\3b576869-a4ec-4529-8536-b80a7769e899':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block execution of potentially obfuscated scripts' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\5beb7efe-fd9a-4556-801d-275e5ffc04cc':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block Office applications from injecting code into other processes' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block Adobe Reader from creating child processes' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block Win32 API calls from Office macro' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block credential stealing from the Windows local security authority subsystem (lsass.exe)' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block untrusted and unsigned processes that run from USB' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block executable content from email client and webmail' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\be9ba2d9-53ea-4cdc-84e5-9b1eeee46550':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block JavaScript or VBScript from launching downloaded executable content' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\d3e037e1-3eb8-44c8-a917-57927947596d':
      ensure:    present
      type:      'string'

  "(L1) Ensure 'ASR - Block Office applications from creating child processes' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\d4f940ab-401b-4efc-aadc-ad5f3c50688a':
      ensure:    present
      type:      'string'

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Allow files to download and save to the host operating system from Microsoft Defender Application Guard":
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\SaveFilesToHost':
      ensure:    present
      data:      0



## ----------- updates from CIS 1809 v1.6.0 ----------- ##

## removed in v1.11.0 21H1
#  "(L1) Ensure 'Allow Sideloading of extension' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Extensions\AllowSideloadingOfExtensions':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Configure detection for potentially unwanted applications' is set to 'Enabled: Block'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\PUAProtection':
      ensure:    present

## removed in v1.9.0 2004
#  "(L1) Ensure 'Allow users to trust files that open in Windows Defender Application Guard' is set to 'Enabled: 0 (Do not allow users to manually trust files)' OR '2 (Allow users to manually trust after an antivirus check)'":
#    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\FileTrustCriteria':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Remove access to 'Pause updates' feature is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\SetDisablePauseUXAccess':
      ensure:    present

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Turn On Virtualization Based Security: Secure Launch Configuration' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\ConfigureSystemGuardLaunch':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\EnableVirtualizationBasedSecurity':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\HVCIMATRequired':
      ensure:    present
#      data:      0
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\HypervisorEnforcedCodeIntegrity':
      ensure:    present
#      data:      3
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\LsaCfgFlags':
      ensure:    present
#      data:      3
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\RequirePlatformSecurityFeatures':
      ensure:    present
      data:      3

## Moved from NG to L1 in v2.0.0 22H2
  "(L1) Ensure 'Allow camera and microphone access in Windows Defender Application Guard'":
    'HKLM\SOFTWARE\Policies\Microsoft\AppHVSI\AllowCameraMicrophoneRedirection':
      ensure:    present
      data:      0



## ----------- updates from CIS 1903/9 v1.7.0/v1.8.0 ----------- ##

  "(L1) Ensure 'Let Windows apps activate with voice while the system is locked' is set to 'Enabled: Force Deny'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy\LetAppsActivateWithVoiceAboveLock':
      ensure:    present
      data:      2

  "(L1) Ensure 'Prevent the use of security questions for local accounts' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\NoLocalPasswordResetQuestions':
      ensure:    present
      data:      1


## ----------- updates from CIS 2004 v1.9.0 ----------- ##

  "(L1) Ensure 'Relax minimum password length limits' is set to 'Enabled' (ie can be above legacy limit of 14)":
    'HKLM\System\CurrentControlSet\Control\SAM\RelaxMinimumPasswordLengthLimits':
      ensure:    present

  "(L1) Ensure 'Prevent non-admin users from installing packaged Windows apps' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx\BlockNonAdminUserInstall':
      ensure:    present

  "(L1) Ensure 'Special Administration Console Helper (sacsvr)' is set to 'Disabled' or 'Not Installed'":
    'HKLM\SYSTEM\CurrentControlSet\Services\sacsvr\Start':
      ensure:    present
      data:      4


## ----------- updates from CIS 20H2 v1.10.0 ----------- ##

  "(L1) Ensure 'Scan all downloaded files and attachments' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection':
      ensure:    present
      data:      0

  "(L1) Ensure 'Turn off real-time protection' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring':
      ensure:    present
      data:      0

  "(L1) ASR - Block persistence through WMI event subscription":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\e6db77e5-3df2-4cf1-b95a-636979351e5b':
      ensure:    present
      type:      'string'


## ----------- updates from CIS 21H1 v1.11.0 ----------- ##

# none


## ----------- updates from CIS 21H2 v1.12.0 ----------- ##

  "(L1) Ensure 'Allow Print Spooler to accept client connections' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RegisterSpoolerRemoteRpcEndPoint':
      ensure:    present
      data:      2

  "(L1) Ensure 'Point and Print Restrictions: When installing drivers for a new connection' is set to 'Enabled: Show warning and elevation prompt'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\NoWarningNoElevationOnInstall':
      ensure:    present
      data:      0

  "(L1) Ensure 'Point and Print Restrictions: When updating drivers for an existing connection' is set to 'Enabled: Show warning and elevation prompt'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\UpdatePromptSettings':
      ensure:    present
      data:      0

  "(L1) Ensure 'Prevent device metadata retrieval from the Internet' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Device Metadata\PreventDeviceMetadataFromNetwork':
      ensure:    present

  "(L1) Ensure 'Limits print driver installation to Administrators' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\RestrictDriverInstallationToAdministrators':
      ensure:    present

## Removed in v4.0.0
#  "(L1) Ensure 'Configure DNS over HTTPS (DoH) name resolution' is set to 'Enabled: Allow DoH' or higher":
## NOTE that this is set to 'Allow DoH'.  Change the data value below to 3 for 'Require DoH', though this may break DNS in some environments
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient\DoHPolicy':
#      ensure:    present
#      data:      2

  "(L1) Ensure 'Turn off cloud consumer account state content' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent\DisableConsumerAccountStateContent':
      ensure:    present

## CIS PDF is missing \Windows in listed regkey path
  "(L1) Ensure 'Enable OneSettings Auditing' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\EnableOneSettingsAuditing':
      ensure:    present

## CIS PDF is missing \Windows in listed regkey path
  "(L1) Ensure 'Limit Diagnostic Log Collection' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\LimitDiagnosticLogCollection':
      ensure:    present

## CIS PDF is missing \Windows in listed regkey path
  "(L1) Ensure 'Limit Dump Collection' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\LimitDumpCollection':
      ensure:    present

  "(L1) Ensure 'Turn on script scanning' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScriptScanning':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow widgets' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Dsh\AllowNewsAndInterests':
      ensure:    present
      data:      0

  "(L1) Ensure 'Disable OneSettings Downloads' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection\DisableOneSettingsDownloads':
      ensure:    present

  "(L1) Ensure 'Allow clipboard sharing with Windows Sandbox' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Sandbox\AllowClipboardRedirection':
      ensure:    present
      data:      0

  "(L1) Ensure 'Allow networking in Windows Sandbox' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Sandbox\AllowNetworking':
      ensure:    present
      data:      0

## Moved to L2 in v4.0.0
#  "(L1) Ensure 'Enable App Installer' is set to 'Disabled'":
#    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableAppInstaller':
#      ensure:    present
#      data:      0

  "(L1) Ensure 'Enable App Installer Experimental Features' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableExperimentalFeatures':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable App Installer Hash Override' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableHashOverride':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable App Installer ms-appinstaller protocol' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableMSAppInstallerProtocol':
      ensure:    present
      data:      0



## ----------- updates from CIS 22H2 v2.0.0 ----------- ##

  "(L1) Ensure 'Configure RPC packet level privacy setting for incoming connections' is set to 'Enabled'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Print\RpcAuthnLevelPrivacyEnabled':
      ensure:    present

  "(L1) Ensure 'Configures LSASS to run as a protected process' is set to 'Enabled: Enabled with UEFI Lock'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL':
      ensure:    present

  "(L1) Ensure 'Configure NetBIOS settings' is set to 'Enabled: Disable NetBIOS name resolution on public networks'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient\EnableNetbios':
      ensure:    present
      data:      2

  "(L1) Ensure 'Configure Redirection Guard' is set to 'Enabled: Redirection Guard Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RedirectionguardPolicy':
      ensure:    present

  "(L1) Ensure 'Configure RPC connection settings: Protocol to use for outgoing RPC connections' is set to 'Enabled: RPC over TCP":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC\RpcUseNamedPipeProtocol':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure RPC connection settings: Use authentication for outgoing RPC connections' is set to 'Enabled: Default'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC\RpcAuthentication':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure RPC listener settings: Protocols to allow for incoming RPC connections' is set to 'Enabled: RPC over TCP'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC\RpcProtocols':
      ensure:    present
      data:      5

  "(L1) Ensure 'Configure RPC listener settings: Authentication protocol to use for incoming RPC connections:' is set to 'Enabled: Negotiate' or higher":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC\ForceKerberosForRpc':
      ensure:    present
      data:      0

  "(L1) Ensure 'Manage processing of Queue-specific files' is set to 'Enabled: Limit Queue-specific files to Color profiles'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\CopyFilesPolicy':
      ensure:    present

  "(L1) Ensure 'Allow Custom SSPs and APs to be loaded into LSASS' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\System\AllowCustomSSPsAPs':
      ensure:    present
      data:      0

  "(L1) Ensure 'ASR - Block abuse of exploited vulnerable signed drivers' is configured":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\56a863a9-875e-4185-98a7-b882c64b5ce5':
      ensure:    present
      type:      'string'

## Renamed from "Ensure 'Enable MPR notifications for the system' is set to 'Disabled'" in v4.0.0
  "(L1) Ensure 'Configure the transmission of the user's password in the content of MPR notifications sent by winlogon.' is set to 'Disabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableMPR':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure RPC over TCP port' is set to 'Enabled: 0'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC\RpcTcpPort':
      ensure:    present
      data:      0

## Win11 settings not present in Win10 benchmark

  "(L1) Ensure 'Turn On Virtualization Based Security: Kernel-mode Hardware-enforced Stack Protection' is set to 'Enabled: Enabled in enforcement mode'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\ConfigureKernelShadowStacksLaunch':
      ensure:    present

  "(L1) Ensure 'Notify Malicious' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WTDS\Components\NotifyMalicious':
      ensure:    present

  "(L1) Ensure 'Notify Password Reuse' is set to'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WTDS\Components\NotifyPasswordReuse':
      ensure:    present

  "(L1) Ensure 'Notify Unsafe App' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WTDS\Components\NotifyUnsafeApp':
      ensure:    present

  "(L1) Ensure 'Service Enabled' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WTDS\Components\ServiceEnabled':
      ensure:    present

  "(L1) Ensure 'Enable ESS with Supported Peripherals' is set to 'Enabled: 1'":
    'HKLM\SOFTWARE\Microsoft\Policies\PassportForWork\Biometrics\EnableESSwithSupportedPeripherals':
      ensure:    present


## ----------- updates from CIS v3.0.0 ----------- ##

  "(L1) Ensure 'Enable Windows NTP Client' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient\Enabled':
      ensure:    present

  "(L1) Ensure 'Enable Windows NTP Server' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer\Enabled':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable file hash computation feature' is set to 'Enabled' (this is missing 'enabled' from key in CIS doc)":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine\EnableFileHashComputation':
      ensure: present

  "(L1) Ensure 'Configure security policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\NoBackgroundPolicy':
      ensure:    present
      data:      0

  "(L1) Ensure 'Configure security policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\NoGPOListChanges':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network security: Restrict NTLM: Audit Incoming NTLM Traffic' is set to 'Enable auditing for all accounts'":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\AuditReceivingNTLMTraffic':
      ensure:    present
      data:      2

  "Ensure 'Network security: Restrict NTLM: Outgoing NTLM traffic to remote servers' is set to 'Audit all' or higher":
    'HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\RestrictSendingNTLMTraffic':
      ensure:    present
#      data:      2

  "(L1) Ensure 'Configure password backup directory' is set to 'Enabled: Active Directory' or 'Enabled: Azure Active Directory'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\BackupDirectory':
      ensure:    present

  "(L1) Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PasswordExpirationProtectionEnabled':
      ensure:    present

  "(L1) Ensure 'Enable password encryption' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\ADPasswordEncryptionEnabled':
      ensure:    present

  "(L1) Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PasswordComplexity':
      ensure:    present
      data:      4

  "(L1) Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PasswordLength':
      ensure:    present
      data:      15

  "(L1) Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PasswordAgeDays':
      ensure:    present
      data:      30

  "(L1) Ensure 'Post-authentication actions: Grace period (hours)' is set to 'Enabled: 8 or fewer hours, but not 0'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PostAuthenticationResetDelay':
      ensure:    present
      data:      8

  "(L1) Ensure 'Post-authentication actions: Actions' is set to 'Enabled: Reset the password and logoff the managed account' or higher":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\LAPS\PostAuthenticationActions':
      ensure:    present
      data:      3

  "(L1) Ensure 'Scan packed executables' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan\DisablePackedExeScanning':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable features introduced via servicing that are off by default' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AllowTemporaryEnterpriseFeatureControl':
      ensure:    present
      data:      0

# Updated in v4.0.0 to add 2nd key for 32bit subsystem
  "(L1) Ensure 'Enable Certificate Padding' is set to 'Enabled'":
    'HKLM\SOFTWARE\Microsoft\Cryptography\Wintrust\Config\EnableCertPaddingCheck':
      ensure:    present
    'HKLM\SOFTWARE\Wow6432Node\Microsoft\Cryptography\Wintrust\Config\EnableCertPaddingCheck':
      ensure:    present

  "(L1) Ensure 'Automatic Data Collection' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WTDS\Components\CaptureThreatWindow':
      ensure:    present

  "(L1) Ensure 'Enable optional updates' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\SetAllowOptionalContent':
      ensure:    present
      data:      0

  "(L1) Ensure 'Hardened UNC Paths' is set to 'Enabled, with 'Require Mutual Authentication' and 'Require Integrity' for all NETLOGON and SYSVOL shares TO add 'Require Privacy'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths\\\\*\NETLOGON':
      ensure: present
      type:   'string'
      data:   'RequireMutualAuthentication=1, RequireIntegrity=1, RequirePrivacy=1'
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths\\\\*\SYSVOL':
      ensure: present
      type:   'string'
      data:   'RequireMutualAuthentication=1, RequireIntegrity=1, RequirePrivacy=1'


## ----------- updates from CIS v4.0.0 ----------- ##
  "(L1) Ensure 'Turn on Basic feed authentication over HTTP' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds\AllowBasicAuthInClear':
      ensure:    present
      data:      0

  "(L1) Ensure 'Network security: LDAP client encryption requirements' is set to 'Negotiate sealing' or higher":
    'HKLM\SYSTEM\CurrentControlSet\Services\LDAP\LDAPClientConfidentiality':
      ensure:    present

  "(L1) Ensure 'Configure multicast DNS (mDNS) protocol' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient\EnableMDNS':
      ensure:    present
      data:      0

  "(L1) Ensure 'Audit client does not support encryption' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\AuditClientDoesNotSupportEncryption':
      ensure:    present

  "(L1) Ensure 'Audit client does not support signing' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\AuditClientDoesNotSupportSigning':
      ensure:    present

  "(L1) Ensure 'Audit insecure guest logon' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\AuditInsecureGuestLogon':
      ensure:    present
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\AuditInsecureGuestLogon':
      ensure:    present

  "(L1) Ensure 'Enable authentication rate limiter' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\EnableAuthRateLimiter':
      ensure:    present

  "(L1) Ensure 'Enable remote mailslots' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Bowser\EnableMailslots':
      ensure:    present
      data:      0
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\EnableMailslots':
      ensure:    present
      data:      0

  "(L1) Ensure 'Mandate the minimum version of SMB' is set to 'Enabled: 3.1.1'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\MinSmb2Dialect':
      ensure:    present
      data:      785
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\MinSmb2Dialect':
      ensure:    present
      data:      785

  "(L1) Ensure 'Set authentication rate limiter delay (milliseconds)' is set to 'Enabled: 2000' or more":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanServer\InvalidAuthenticationDelayTimeInMs':
      ensure:    present
      data:      2000

  "(L1) Ensure 'Audit server does not support encryption' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\AuditServerDoesNotSupportEncryption':
      ensure:    present

  "(L1) Ensure 'Audit server does not support signing' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\AuditServerDoesNotSupportSigning':
      ensure:    present

  "(L1) Ensure 'Configure the behavior of the sudo command' is set to 'Enabled: Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Sudo\Enabled':
      ensure:    present
      data:      0

  "(L1) Ensure 'Block NetBIOS-based discovery for domain controller location' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Netlogon\Parameters\BlockNetbiosDiscovery':
      ensure:    present

  "(L1) Ensure 'Configure SAM change password RPC methods policy' is set to 'Enabled: Block all change password RPC methods'":
    'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\SAM\SamrChangeUserPasswordApiPolicy':
      ensure:    present

  "(L1) Ensure 'Not allow per-user unsigned packages to install by default (requires explicitly allow per install)' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx\DisablePerUserUnsignedPackagesByDefault':
      ensure:    present

  "(L1) Ensure 'Enable App Installer Local Archive Malware Scan Override' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableLocalArchiveMalwareScanOverride':
      ensure:    present
      data:      0

  "(L1) Ensure 'Enable App Installer Microsoft Store Source Certificate Validation Bypass' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppInstaller\EnableBypassCertificatePinningForMicrosoftStore':
      ensure:    present
      data:      0

  "(L1) Ensure 'Do not apply the Mark of the Web tag to files copied from insecure sources' is set to 'Disabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer\DisableMotWOnInsecurePathCopy':
      ensure:    present
      data:      0

  "(L1) Ensure 'Control whether exclusions are visible to local users' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\HideExclusionsFromLocalUsers':
      ensure:    present

  "(L1) Ensure 'Enable EDR in block mode' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Features\PassiveRemediation':
      ensure:    present

  "(L1) Ensure 'Configure real-time protection and Security Intelligence Updates during OOBE' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\OobeEnableRtpAndSigUpdate':
      ensure:    present

  "(L1) Ensure 'Configure Remote Encryption Protection Mode' is set to 'Enabled: Audit' or higher":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Remediation\Behavioral Network Blocks\Brute Force Protection\BruteForceProtectionConfiguredState':
      ensure:    present

  "(L1) Ensure 'Scan excluded files and directories during quick scans' is set to 'Enabled: 1'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan\QuickScanIncludeExclusions':
      ensure:    present

  "(L1) Ensure 'Trigger a quick scan after X days without any scans' is set to 'Enabled: 7'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan\DaysUntilAggressiveCatchupQuickScan':
      ensure:    present
      data:      7

  "(L1) Ensure 'Require Encryption' is set to 'Enabled'":
    'HKLM\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\RequireEncryption':
      ensure:    present
